import{T as e}from"./index.c3d311dd.js";import{d as a}from"./utils.3dd1a93e.js";import{d as t,L as l,k as o,x as r,_ as n,r as s,o as d,z as i,w as c,b as m,j as u,A as p,c as h,a as g,B as f,C as b,f as y}from"./index.a5d69c1c.js";import{u as w,a as D,g as C,d as v,b as _}from"./choose.f9744687.js";const x=t({components:{Layer:l},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0,width:"400px"})}},setup(e){const a=o(null),t=o(null),l=o({category:""});return e.layer.row&&(l.value=JSON.parse(JSON.stringify(e.layer.row))),{layerDom:a,formRef:t,modeForm:l,rules:{category:[{required:!0,message:"请输入选择分类",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}}},methods:{submit(){this.formRef&&this.formRef.validate((e=>{if(e){let e=this.modeForm;this.layer.row?w(e):D(e),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()}}))},addChoose(e){D(e).then((e=>{r.success({message:e.msg})})).catch((e=>{r.error(res.msg)}))},updateChoose(e){w(e).then((e=>{200===e.status?r.success(e.msg):r.error(e.msg)})).catch((e=>{r.error(res.msg)}))}}});const S=t({name:"ChooseSetting",components:{Table:e,Layer:n(x,[["render",function(e,a,t,l,o,r){const n=s("el-input"),u=s("el-form-item"),p=s("el-form"),h=s("Layer",!0);return d(),i(h,{layer:e.layer,ref:"layerDom",onConfirm:e.submit},{default:c((()=>[m(p,{ref:"formRef",model:e.modeForm,rules:e.rules,"label-width":"80px"},{default:c((()=>[m(u,{label:"内容分类",prop:"category"},{default:c((()=>[m(n,{modelValue:e.modeForm.category,"onUpdate:modelValue":a[0]||(a[0]=a=>e.modeForm.category=a),placeholder:"请输入选择分类",clearable:""},null,8,["modelValue"])])),_:1}),m(u,{label:"内容",prop:"content"},{default:c((()=>[m(n,{modelValue:e.modeForm.content,"onUpdate:modelValue":a[1]||(a[1]=a=>e.modeForm.content=a),placeholder:"请输入选择内容",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["layer","onConfirm"])}]])},setup(){const e=o(!0),t=o([]),l=u({pageNum:1,pageSize:10,total:0,content:""}),n=o([]),s=u({show:!1,title:"添加点位",showButton:!0,width:"400px"}),d=a=>{e.value=!0,a&&(l.pageNum=1);let o={pageNum:l.pageNum,pageSize:l.pageSize};C(o).then((a=>{let o=a.data.list;t.value=o,l.total=Number(a.data.total),e.value=!1})).catch((a=>{r.error(res.msg),e.value=!1,t.value=[],l.pageNum=1,l.total=0,e.value=!1}))};return d(!0),{loading:e,tableData:t,page:l,layer:s,dateFormat:a,chooseData:n,getTableData:d,handleChoose:()=>{s.title="添加选择",s.show=!0,s.width="400px"},handleEdit:e=>{s.title="编辑选择",s.show=!0,s.width="400px",s.row=e},handleDel:e=>{let a={id:e.id};v(a).then((e=>{200===e.status?r.success(e.msg):r({message:e.msg,type:"error"}),d(1===t.value.length)})).catch((e=>{r({message:res.msg,type:"error"})}))},handleBatchDel:e=>{let a=[];e.map((e=>{a.push(e.id)}));const l={chooseIds:a};console.log("params",l),_(l).then((e=>{r.success(e.msg),d(1===t.value.length)})).catch((e=>{r.error(e)}))},handleSelectionChange:e=>{n.value=e}}}}),T={class:"layout-container"},F={class:"layout-container-form flex space-between"},N={class:"layout-container-form-handle"},j=y(" 添加选择"),k=y("批量删除"),V={class:"layout-container-table"},B=y("编辑"),L=y("删除");var z=n(S,[["render",function(e,a,t,l,o,r){const n=s("el-button"),u=s("el-popconfirm"),y=s("el-table-column"),w=s("Table"),D=s("Layer"),C=p("loading");return d(),h("div",T,[g("div",F,[g("div",N,[m(n,{type:"primary",icon:"el-icon-plus",onClick:e.handleChoose},{default:c((()=>[j])),_:1},8,["onClick"]),m(u,{title:"批量删除",onConfirm:a[0]||(a[0]=a=>e.handleBatchDel(e.chooseData))},{reference:c((()=>[m(n,{type:"danger",icon:"el-icon-delete",disabled:0===e.chooseData.length},{default:c((()=>[k])),_:1},8,["disabled"])])),_:1})])]),g("div",V,[f(m(w,{ref:"table",page:e.page,"onUpdate:page":a[1]||(a[1]=a=>e.page=a),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:c((()=>[m(y,{prop:"id",label:"id",align:"center","show-overflow-tooltip":""}),m(y,{prop:"content",label:"选择内容",align:"center"}),m(y,{prop:"category",label:"内容分类",align:"center"}),m(y,{prop:"state",label:"状态",align:"center",width:"60"}),m(y,{prop:"create_time",label:"创建时间",formatter:e.dateFormat,align:"center"},null,8,["formatter"]),m(y,{prop:"update_time",label:"更新时间",formatter:e.dateFormat,align:"center"},null,8,["formatter"]),m(y,{label:"操作",align:"center",fixed:"right",width:"180"},{default:c((a=>[m(n,{onClick:t=>e.handleEdit(a.row)},{default:c((()=>[B])),_:2},1032,["onClick"]),m(u,{title:"删除",onConfirm:t=>e.handleDel(a.row)},{reference:c((()=>[m(n,{type:"danger"},{default:c((()=>[L])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["page","data","onGetTableData","onSelectionChange"]),[[C,e.loading]]),e.layer.show?(d(),i(D,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):b("",!0)])])}]]);export{z as default};
